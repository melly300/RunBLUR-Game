<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0">
<title>Runner Game</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  background: #eaf4ff;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
canvas { display:block; }

/* MENU */
#menu {
  position: absolute;
  inset: 0;
  background: linear-gradient(#bde7ff,#ffffff);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

#playBtn {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  background: green;
  clip-path: polygon(35% 25%, 35% 75%, 75% 50%);
  cursor: pointer;
  margin-top: 40px;
}
</style>
</head>
<body>

<div id="menu">
  <canvas id="menuCanvas" width="300" height="300"></canvas>
  <div id="playBtn"></div>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const menuCanvas = document.getElementById("menuCanvas");
const mctx = menuCanvas.getContext("2d");
const menu = document.getElementById("menu");
const playBtn = document.getElementById("playBtn");

const menuMusic = new Audio("music.mp3");
menuMusic.loop = true;
menuMusic.volume = 0.5;

let gameStarted = false;

// resize
function resizeCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize",resizeCanvas);
resizeCanvas();

// ground
let groundY;
function updateGround(){ groundY = canvas.height*0.8; }
updateGround();

// entities
let player={ x:canvas.width*0.3, y:0, vy:0, jumping:false };
let police={ x:canvas.width*0.15, y:0 };
let obstacles=[];
let coins=[];

let gravity=1;
let score=0;
let coinsCollected=0;
let speed=0.008;
let gameOver=false;
let step=0;
let bgOffset=0;

// MENU DANCE
let danceStep=0;
function drawMenuGuy(){
  mctx.clearRect(0,0,300,300);
  const run=Math.sin(danceStep*0.2)*10;
  mctx.fillStyle="#2563eb";
  mctx.beginPath();
  mctx.ellipse(150,170,20,40,0,0,Math.PI*2);
  mctx.fill();

  mctx.fillStyle="#5a3a1a";
  mctx.beginPath();
  mctx.arc(150,110,20,0,Math.PI*2);
  mctx.fill();

  mctx.fillStyle="gold";
  mctx.beginPath();
  mctx.arc(150,145,12,0,Math.PI);
  mctx.stroke();

  mctx.fillStyle="#2563eb";
  mctx.beginPath();
  mctx.ellipse(120,170+run,10,30,0,0,Math.PI*2);
  mctx.ellipse(180,170-run,10,30,0,0,Math.PI*2);
  mctx.fill();

  danceStep++;
  requestAnimationFrame(drawMenuGuy);
}
drawMenuGuy();
menuMusic.play();

// PLAY BUTTON
playBtn.onclick=()=>{
  menu.style.display="none";
  menuMusic.pause();
  gameStarted=true;
};

// INPUT
function jump(){
  if(!gameStarted) return;
  if(!player.jumping){
    player.vy=-canvas.height*0.04;
    player.jumping=true;
  }
}
document.addEventListener("keydown",jump);
document.addEventListener("click",jump);
document.addEventListener("touchstart",jump);

// SPAWN
function spawnObstacle(){
  obstacles.push({ x:canvas.width, y:groundY, w:canvas.width*0.05, h:canvas.height*0.12 });
}
setInterval(spawnObstacle,1800);

function spawnCoin(){
  coins.push({
    x:canvas.width,
    y:groundY-canvas.height*0.15,
    r:12
  });
}
setInterval(spawnCoin,1200);

// UPDATE
function update(){
  if(!gameStarted || gameOver) return;

  player.y+=player.vy;
  player.vy+=gravity;

  if(player.y>=groundY){
    player.y=groundY;
    player.jumping=false;
  }

  police.y=player.y;

  for(let obs of obstacles){
    obs.x-=canvas.width*speed;
  }

  for(let coin of coins){
    coin.x-=canvas.width*speed;
  }

  // collect coins
  coins=coins.filter(c=>{
    if(
      player.x<c.x+c.r &&
      player.x+40>c.x-c.r &&
      player.y-100<c.y+c.r &&
      player.y>c.y-c.r
    ){
      coinsCollected++;
      return false;
    }
    return c.x>0;
  });

  obstacles=obstacles.filter(o=>o.x+o.w>0);

  score++; step++; bgOffset-=canvas.width*0.001;
}

// BACKGROUND
function drawBackground(){
  ctx.fillStyle="#bde7ff";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle="#ccc";
  for(let i=0;i<20;i++){
    let x=(i*220+bgOffset*0.5)%canvas.width;
    ctx.fillRect(x,groundY-220,140,220);
  }
}

// PLAYER
function drawPlayer(){
  const px=player.x, py=player.y;
  const run=Math.sin(step*0.3)*10;

  ctx.save();
  ctx.translate(px,py-60);

  ctx.fillStyle="#1e3fa3";
  ctx.beginPath();
  ctx.ellipse(-6,30-run,7,26,0,0,Math.PI*2);
  ctx.ellipse(10,30+run,7,26,0,0,Math.PI*2);
  ctx.fill();

  ctx.fillStyle="#2563eb";
  ctx.beginPath();
  ctx.ellipse(2,0,16,30,0,0,Math.PI*2);
  ctx.fill();

  ctx.fillStyle="#5a3a1a";
  ctx.beginPath();
  ctx.arc(0,-50,14,0,Math.PI*2);
  ctx.fill();

  ctx.strokeStyle="gold";
  ctx.beginPath();
  ctx.arc(0,-28,8,0,Math.PI);
  ctx.stroke();

  ctx.restore();
}

// POLICE
function drawPolice(){
  const px=police.x, py=police.y;
  const run=Math.sin(step*0.3+1)*10;

  ctx.save();
  ctx.translate(px,py-60);

  ctx.fillStyle="#111827";
  ctx.beginPath();
  ctx.ellipse(2,0,16,30,0,0,Math.PI*2);
  ctx.fill();

  ctx.fillStyle="#000";
  ctx.fillRect(-14,-65,28,6);

  ctx.restore();
}

// BINS
function drawObstacles(){
  for(let obs of obstacles){
    ctx.fillStyle="#2f7d32";
    ctx.fillRect(obs.x,obs.y-obs.h,obs.w,obs.h);
  }
}

// COINS
function drawCoins(){
  for(let c of coins){
    ctx.fillStyle="gold";
    ctx.beginPath();
    ctx.arc(c.x,c.y,c.r,0,Math.PI*2);
    ctx.fill();
  }
}

// GROUND
function drawGround(){
  ctx.fillStyle="#555";
  ctx.fillRect(0,groundY,canvas.width,6);
}

// SCORE
function drawScore(){
  ctx.fillStyle="black";
  ctx.font=(canvas.width*0.04)+"px Arial";
  ctx.fillText("Score: "+score+"  Coins: "+coinsCollected,20,40);
}

// LOOP
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  updateGround();
  update();
  drawBackground();
  drawGround();
  drawPolice();
  drawPlayer();
  drawObstacles();
  drawCoins();
  drawScore();

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
